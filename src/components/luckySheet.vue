<template>
  <div>
    <el-button type="primary" size="default" @click="setData">设置数据</el-button>
    <!-- 在线预览容器 -->
    <div id="luckysheet"></div>
  </div>
</template>

<script setup>
import { onMounted, nextTick } from 'vue'

let header_style = {
  fs: 12,
  ht: 0,
  vt: 0,
  bg: '#909399',
}

nextTick(() => {
  var options = {
    container: 'luckysheet', //luckysheet为容器id
    lang: 'zh',
    title: '财务月报',
    showinfobar: false,
    data: [
      {
        name: 'Cell',
        celldata: [
          {
            r: 0,
            c: 0,
            v: {
              ...header_style,
              m: '部门',
              v: '部门',
            },
          },
          {
            r: 0,
            c: 1,
            v: {
              ...header_style,
              m: '科目',
              v: '科目',
            },
          },
          {
            r: 0,
            c: 2,
            v: {
              ...header_style,
              m: '事项',
              v: '事项',
            },
          },
          {
            r: 0,
            c: 3,
            v: {
              ...header_style,
              m: '内容',
              v: '内容',
            },
          },
          {
            r: 0,
            c: 4,
            v: {
              ...header_style,
              m: '2024年6月',
              v: '2024年6月',
            },
          },
          {
            r: 1,
            c: 4,
            v: {
              ...header_style,
              m: '目标',
              v: '目标',
            },
          },
          {
            r: 1,
            c: 5,
            v: {
              ...header_style,
              m: '目标IYA',
              v: '目标IYA',
            },
          },
          {
            r: 1,
            c: 6,
            v: {
              ...header_style,
              m: '目标费比',
              v: '目标费比',
            },
          },
          {
            r: 1,
            c: 7,
            v: {
              ...header_style,
              m: '实际',
              v: '实际',
            },
          },
          {
            r: 1,
            c: 8,
            v: {
              ...header_style,
              m: '实际完成率',
              v: '实际完成率',
            },
          },
          {
            r: 1,
            c: 9,
            v: {
              ...header_style,
              m: '实际费比',
              v: '实际费比',
            },
          },
          {
            r: 1,
            c: 10,
            v: {
              ...header_style,
              m: '预估',
              v: '预估',
            },
          },
          {
            r: 1,
            c: 11,
            v: {
              ...header_style,
              m: '预估完成率',
              v: '预估完成率',
            },
          },
          {
            r: 1,
            c: 12,
            v: {
              ...header_style,
              m: '预估费比',
              v: '预估费比',
            },
          },
          {
            r: 1,
            c: 13,
            v: {
              ...header_style,
              m: '同期',
              v: '同期',
            },
          },
          {
            r: 1,
            c: 14,
            v: {
              ...header_style,
              m: '实际IYA',
              v: '实际IYA',
            },
          },
          {
            r: 1,
            c: 15,
            v: {
              ...header_style,
              m: '同期费比',
              v: '同期费比',
            },
          },
        ],
        config: {
          merge: {
            '0_0': {
              r: 0,
              c: 0,
              rs: 2,
              cs: 1,
            },
            '0_1': {
              r: 0,
              c: 1,
              rs: 2,
              cs: 1,
            },
            '0_2': {
              r: 0,
              c: 1,
              rs: 2,
              cs: 1,
            },
            '0_3': {
              r: 0,
              c: 1,
              rs: 2,
              cs: 1,
            },
            '0_4': {
              r: 0,
              c: 4,
              rs: 1,
              cs: 12,
            },
          },
        },
      },
    ],
  }
  luckysheet.create(options)
})

function setData() {
  let data = [
    ['事业六部', 'GMV', '', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '平台费用', '平台佣金', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售成本', '产品成本', '采购折扣', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '平台费用', '平台费用小计', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', 'GMV', '单量', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '前台销售毛利', '', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '营销推广费用合计', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '前台销售毛利', '前台销售毛利', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售成本', '商品成本合计', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', 'GMV', '客单价', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', 'GMV', '', '退后数量*RSP', '0', '0.00%', '0.00%', '0', '0.00%', '0.00%', '0', '0.00%', '0.00%', '0', '0.00%', '0.00%'],
    ['事业六部', '营销推广费用', '平台费用', '其他费用', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', 'GMV', '退后GMV合计', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售成本', '进货货补', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售成本', '进货返利', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '推广费用', '资源费用', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售成本', '商品损耗', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售成本', '进货返利', '合同内月返', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '补贴后销售毛利', '', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '推广费用', '会员费用', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '推广费用', '淘客佣金', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '种草费用', '内容费用', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', 'GMV', '合同目标GMV', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售成本', '产品成本', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售成本', '进货返利', '其他返利', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '平台费用', '保险费用', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', 'GMV', '', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售收入', '', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售收入', '销售收入', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '推广费用', '直播佣金', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '推广费用', '店播费用', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售收入', '销售净收入合计', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '种草费用', '达人费用', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '推广费用', '站内推广', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '种草费用', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', 'GMV', '合同目标GMV', '合同目标GMV', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售成本', '进货返利', '合同内年返', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售成本', '进货返利', '合同内季返', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '平台费用', '信用手续费', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', 'GMV', '退后GMV合计', 'TOC的退后GMV', '￥0.0', '0.00%', '', '￥0.0', '0.00%', '', '￥0.0', '0.00%', '', '￥0.0', '0.00%', ''],
    ['事业六部', '营销推广费用', '推广费用', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '推广费用', '推广费用小计', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售成本', '产品成本', '产品成本', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '种草费用', '投流费用', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', 'GMV', '销售折扣', '', '0', '0.00%', '0.00%', '0', '0.00%', '0.00%', '0', '0.00%', '0.00%', '0', '0.00%', '0.00%'],
    ['事业六部', '销售成本', '', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '推广费用', '直播坑位费', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '补贴后销售毛利', '补贴后销售毛利', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '前台销售毛利', '前台销售毛利率', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '种草费用', '种草费用合计', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售收入', '销售收入', '销售回款', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', 'ISV费用', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '平台费用', '平台返点', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '平台费用', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '平台费用', '软件费用', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售成本', '赠品成本', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售收入', '平台毛保', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '营销推广费用', '设计费用', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售成本', '进货返利', '返利合计', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '补贴后销售毛利', '补贴后销售毛利率', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售成本', '商品损耗', '销退未赔付、盘盈亏、报废等', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
    ['事业六部', '销售成本', '进货货补', '（合同外）亏损补贴', '', '0.00%', '', '', '0.00%', '', '', '0.00%', '', '', '0.00%', ''],
  ]
  console.log(data)
  data.forEach((row, rowIndex) => {
    row.forEach((cell, cellIndex) => {
      luckysheet.setCellValue(rowIndex + 2, cellIndex, cell)
    })
  })
}
</script>
<style scoped>
#luckysheet {
  width: 100vw;
  height: 100vh;
}
</style>
